# UnionFind



## 模板

```python
class UnionFind:
    def __init__(self, grid):
        row = len(grid)
        col = len(grid[0])
        self.root = [-1] * (row * col)
        for i in range(row * col):
            self.root[i] = i
            
            
        def find(self, x):
            if self.root[x] != x:
                self.find(self.root[x])
            return self.root[x]
        
        def union(self, x, y):
            self.root[self.find(x)] = self.find(y)        
```



优化（基于权重优化）

```python
class UnionFind:
    def __init__(self, grid):
        row = len(grid)
        col = len(grid[0])
        self.root = [-1] * (row * col)
        self.rank = [0] * (row * col)
        
        for i in range(row * col):
            self.root[i] = i
            
            
        def find(self, x): # quick find
            if x != self.root[x]:
                self.root[x] = self.find(self.root[x])
            return self.root[x]

            
        
        def union(self, x, y):
            rootx = self.find(x)
            rooty = self.find(y)
            if rootx != rooty: # quick union 防止树太高： 比较两个数的高；把矮的树连接到高的树上；使得树的高度最低；
                if self.rank[rootx] >self.rank[rooty]:
                    root[rooty] = root[rootx]
                elif self.rank[rootx] < self.rank[rooty]:
                    root[rootx] = rooty
                else:
                    root[rooty] = rootx
                    self.rank[rootx] += 1
```



### [省份数量](https://leetcode-cn.com/problems/number-of-provinces/)

```python
class Solution:
    def findCircleNum(self, isConnected: List[List[int]]) -> int:
        n = len(isConnected)
        res = list(range(n))

        def find(x):
            if res[x] != x:
                res[x] = find(res[x])
            return res[x]
        
        def union(x, y):
            res[find(x)] = find(y) #find(x)是res[x]的值，储存根节点下标，然后改res[根节点下标]，使得其根节点变成y根节点
        
        for i in range(n):
            for j in range(i+1, n):
                if isConnected[i][j] == 1:
                    union(i, j)

        return sum(res[i] == i for i in range(n))
      
```

